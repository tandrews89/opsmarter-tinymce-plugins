/*global tinymce:true */
tinymce.PluginManager.add('CRRequest', function (editor) {
    function showDialog() {
        editor.windowManager.open({
            title: 'Generate Change Request Template',
            body: [{
                type: 'textbox',
                name: 'client_name',
                size: 20,
                label: 'Client Name',
            }, {
                type: 'textbox',
                name: 'subject',
                size: 20,
                label: 'Subject',
            }, {
                type: 'textbox',
                name: 'support_case_notes',
                size: 20,
                label: 'Support Case Notes',
            }, {
                type: 'combobox',
                name: 'timezone',
                size: 20,
                label: 'Client Time Zone',
                values: [{
                    text: "Eastern",
                    value: "EST"
                }, {
                    text: "Central",
                    value: "CST"
                }, {
                    text: "Mountain",
                    value: "MST"
                }]
            }, {
                type: 'textbox',
                name: 'start_date',
                size: 20,
                label: 'Start Time / Date',
            }, {
                type: 'textbox',
                name: 'end_date',
                size: 20,
                label: 'End Time / Date',
            }, {
                type: 'checkbox',
                name: 'downtime_required',
                size: 20,
                label: 'Downtime Required',
            }],
            onsubmit: function (e) {
                editor.execCommand("mceInsertContent", false, 'Hi ' + e.data.client_name + ',<br /><br />I have scheduled the rolling restart for the time you provided me. I have provided the details of the work to be completed below. <br />&nbsp;<table border="0" cellpadding="0" cellspacing="0" style="width:680px"><tbody><tr><td colspan="3" style="height:20px; width:680px"><strong>Instructions</strong></td></tr><tr><td colspan="3" style="height:91px; width:680px">The following information has been submitted to our Operations Team to address your request. Please confirm this information is correct by responding to the case note.&nbsp; If this information is incorrect or you wish to change the time, please update this case and call support immediately.&nbsp; Support can be reached at (888) 788-5264 (North America) or +1.202.715.6019 (International).&nbsp; Additional International toll-free numbers are listed on Behind the Blackboard.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr><tr><td colspan="3" style="height:20px"><strong>Change Request Information</strong></td></tr><tr><td style="height:20px">Subject</td><td colspan="2">' + e.data.subject + '</td></tr><tr><td style="height:20px">Description (Server Info)</td><td colspan="2">N/A</td></tr><tr><td style="height:20px">Production/Staging/Test/Development</td><td colspan="2">Production</td></tr><tr><td style="height:21px">Support Case Notes</td><td colspan="2">' + e.data.support_case_notes + '</td></tr><tr><td colspan="3" style="height:20px"><strong>Scheduling Information</strong></td></tr><tr><td colspan="2" style="height:20px">Client Time Zone: ' + e.data.timezone + '</td><td>Blackboard : US Eastern Time</td></tr><tr><td style="height:20px">Start Date &amp; Time Requested</td><td colspan="2">' + e.data.start_date + '</td></tr><tr><td style="height:20px">End Date &amp; Time Requested</td><td colspan="2">' + e.data.end_date + '</td></tr><tr><td style="height:21px">Required Downtime&nbsp; Yes/No&nbsp;</td><td colspan="2">' + (e.data.downtime_required ? 'Yes' : 'No') + '</td></tr><tr><td colspan="3" style="height:20px"><strong>Guidelines for Submitting a Change Request</strong></td></tr><tr><td colspan="3" style="height:101px; width:680px">Minimum advance notice of a one business day is required to submit a change request via Behind the Blackboard or&nbsp; support case email.&nbsp;&nbsp; If you have an urgent request that does not allow for a full business day&rsquo;s notice, please call support&nbsp; at (888) 788-5264 (North America) or +1.202.715.6019 (International).&nbsp; Additional International toll-free numbers are listed on Behind the Blackboard.</td></tr></tbody></table>');
            }
        });
    }
    editor.addMenuItem('CRRequest', {
        text: 'Change Request Template',
        context: 'insert',
        onclick: showDialog
    });
});